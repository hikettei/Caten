(in-package :caten/test-suite)
;; [TODO] Test unsymmetric padding
(deftest padding-test
  (let ((caten/aasm:*default-order* :row))
    ;; TODO: Counting the number of kernels
    (ok (every #'= (elements (proceed (!sin (caten/nn:!padding (make-tensor `(10 10) :initial-element 2.0) `((2 2) (2 2)) :value 1.0)))))
	#(0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096
	  0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096
	  0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096
	  0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096
	  0.84147096 0.84147096 0.9092974 0.9092974 0.9092974 0.9092974 0.9092974
	  0.9092974 0.9092974 0.9092974 0.9092974 0.9092974 0.84147096 0.84147096
	  0.84147096 0.84147096 0.9092974 0.9092974 0.9092974 0.9092974 0.9092974
	  0.9092974 0.9092974 0.9092974 0.9092974 0.9092974 0.84147096 0.84147096
	  0.84147096 0.84147096 0.9092974 0.9092974 0.9092974 0.9092974 0.9092974
	  0.9092974 0.9092974 0.9092974 0.9092974 0.9092974 0.84147096 0.84147096
	  0.84147096 0.84147096 0.9092974 0.9092974 0.9092974 0.9092974 0.9092974
	  0.9092974 0.9092974 0.9092974 0.9092974 0.9092974 0.84147096 0.84147096
	  0.84147096 0.84147096 0.9092974 0.9092974 0.9092974 0.9092974 0.9092974
	  0.9092974 0.9092974 0.9092974 0.9092974 0.9092974 0.84147096 0.84147096
	  0.84147096 0.84147096 0.9092974 0.9092974 0.9092974 0.9092974 0.9092974
	  0.9092974 0.9092974 0.9092974 0.9092974 0.9092974 0.84147096 0.84147096
	  0.84147096 0.84147096 0.9092974 0.9092974 0.9092974 0.9092974 0.9092974
	  0.9092974 0.9092974 0.9092974 0.9092974 0.9092974 0.84147096 0.84147096
	  0.84147096 0.84147096 0.9092974 0.9092974 0.9092974 0.9092974 0.9092974
	  0.9092974 0.9092974 0.9092974 0.9092974 0.9092974 0.84147096 0.84147096
	  0.84147096 0.84147096 0.9092974 0.9092974 0.9092974 0.9092974 0.9092974
	  0.9092974 0.9092974 0.9092974 0.9092974 0.9092974 0.84147096 0.84147096
	  0.84147096 0.84147096 0.9092974 0.9092974 0.9092974 0.9092974 0.9092974
	  0.9092974 0.9092974 0.9092974 0.9092974 0.9092974 0.84147096 0.84147096
	  0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096
	  0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096
	  0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096
	  0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096 0.84147096))))
